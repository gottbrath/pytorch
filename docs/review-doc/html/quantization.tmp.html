


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title> &mdash; PyTorch master documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://pytorch.org/docs/stable/quantization.tmp.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/katex-math.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/features">Features</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li class="active">
            <a href="https://pytorch.org/docs/stable/index.html">Docs</a>
          </li>

          <li>
            <a href="https://pytorch.org/resources">Resources</a>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  master (1.3.0a0+9c16518 )
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
<div>
  <a style="color:#F05732" href="https://pytorch.org/docs/stable/quantization.tmp.html">
    You are viewing unstable developer preview docs.
    Click here to view docs for latest stable release.
  </a>
</div>

            
            
              
            
            
              <p class="caption"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notes/autograd.html">Autograd mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/broadcasting.html">Broadcasting semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/cpu_threading_torchscript_inference.html">CPU threading and TorchScript inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/cuda.html">CUDA semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/extending.html">Extending PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/large_scale_deployments.html">Features for large-scale deployments</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/multiprocessing.html">Multiprocessing best practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/randomness.html">Reproducibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/serialization.html">Serialization semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes/windows.html">Windows FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="community/contribution_guide.html">PyTorch Contribution Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="community/governance.html">PyTorch Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="community/persons_of_interest.html">PyTorch Governance | Persons of Interest</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="torch.html">torch</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn.html">torch.nn</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn.functional.html">torch.nn.functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensors.html">torch.Tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensor_attributes.html">Tensor Attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="autograd.html">torch.autograd</a></li>
<li class="toctree-l1"><a class="reference internal" href="cuda.html">torch.cuda</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributed.html">torch.distributed</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributions.html">torch.distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="hub.html">torch.hub</a></li>
<li class="toctree-l1"><a class="reference internal" href="jit.html">torch.jit</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn.init.html">torch.nn.init</a></li>
<li class="toctree-l1"><a class="reference internal" href="onnx.html">torch.onnx</a></li>
<li class="toctree-l1"><a class="reference internal" href="optim.html">torch.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="quantization.html">Quantization</a></li>
<li class="toctree-l1"><a class="reference internal" href="random.html">torch.random</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparse.html">torch.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="storage.html">torch.Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="bottleneck.html">torch.utils.bottleneck</a></li>
<li class="toctree-l1"><a class="reference internal" href="checkpoint.html">torch.utils.checkpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="cpp_extension.html">torch.utils.cpp_extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">torch.utils.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="dlpack.html">torch.utils.dlpack</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_zoo.html">torch.utils.model_zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensorboard.html">torch.utils.tensorboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="type_info.html">Type Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="__config__.html">torch.__config__</a></li>
</ul>

            
          

        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li></li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="_sources/quantization.tmp.rst.txt" rel="nofollow"><img src="_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <p>Quantization===========================Introduction to Quantization—————————-Quantization refers to techniques for performing computations and storing tensors at lower bitwidths thanfloating point precision. A quantized model executes some or all of the operations on tensors withintegers rather than floating point values. This allows for a morecompact model representation and the use of high performance vectorizedoperations on many hardware platforms. PyTorch supports INT8quantization compared to typical FP32 models allowing for a 4x reduction in the model size anda 4x reduction in memory bandwidth requirements.  Hardware support for  INT8 computationsis typically 2 to 4 times faster compared to FP32 compute. Quantization is primarily a techniqueto speed up inference and only the forward pass is supported for quantized operators.PyTorch supports multiple approaches to quantizing a deep learning model. In most cases the model is trained in FP32 and then the model is converted to INT8.In addition, PyTorch also supports quantization aware training, which models quantization errorsin both the forward and backward passes using fake-quantization modules. Note that the entirecomputation is carried out in floating point. At the end of quantization aware training, pytorchprovides conversion functions to convert the trained model into lower precision.At lower level, PyTorch provides a way to represent quantized tensors andperform operations with them. They can be used to directly construct models thatperform all or part of the computation in lower precision. Higher-level APIs areprovided that incorporate typical workflows of converting FP32 model to lowerprecision with minimal accuracy loss.Quantized representation and operations—————————————PyTorch supports both per tensor and per channel asymmetric linearquantization. Per tensor means that all the values within the tensor arescaled the same way. Per channel means that for each dimension, typicallythe channel dimension of a tensor, the valuesin the tensor are scaled and offset by a different value (effectivelythe scale and offset become vectors). This allows for lesser error in converting tensorsto quantized values.The mapping is performed by converting the floating point tensors using<strong>*include image of the formula from the design doc here*</strong>Note that, we ensure that zero in floating point is repsresented with no error after quantization,thereby ensuring that operations like padding do not cause additional quantization error.Quantized Tensor~~~~~~~~~~~~~~~~In order to do quantization in PyTorch, we need to be able to representquantized data in Tensors. A quantized Tensor allows for storingquantized data (represented as int8/uint8/int32) along with quantizationparameters like scale and zero\_point. Quantized tensors allow for manyuseful operations making quantized arithmetic easy, in addition toallowing for serialization of data in a quantized format.Operation coverage~~~~~~~~~~~~~~~~~~Quantized tensors support a limited subset of data manipulation methods of the regularfull-precision tensor. &lt;Link to quantized tensor documentation here&gt;For NN operators included in PyTorch, we restrict support to:1. 8 bit weights (data\_type = qint8)2. 8 bit activations (data\_type = quint8)[Note: Bias is now in floating point in our APIs, removing this line below]Note that operator implementations currently onlysupport per channel quantization for weights of the <strong>conv</strong> and <strong>linear</strong>operators. Furthermore the minimum and the maximum of the input data ismapped linearly to the minimum and the maximum of the quantized datatype such that zero is represented with no quantization error.Additional data types and quantization schemes can be implemented throughthe custom operator mechanism.[Note: Will be good to point a link here]Many operations for quantized tensors are available under the same API as fullfloat version in <code class="docutils literal notranslate"><span class="pre">torch</span></code> or <code class="docutils literal notranslate"><span class="pre">torch.nn</span></code>. Quantized version of NN modules thatperform re-quantization are available in <code class="docutils literal notranslate"><span class="pre">torch.nn.quantized</span></code>. Thoseoperations explicitly take output quantization parameters (scale and bias) inthe operation signature.Current quantized operation list is sufficient to cover typical CNN and RNNmodels:TODO: explicit list hereQuantization Workflows———————-PyTorch provides three approaches to quantize models.1. Dynamic Quantization: This is the simplest to apply form of</p>
<blockquote>
<div><p>quantization where the weights are quantized ahead of time but theactivations are dynamically quantized  during inference. This is usedfor situations where the model execution time is dominated by loadingweights from memory rather than computing the matrix multiplications.This is true for for LSTM and Transformer type models with smallbatch size. Applying dynamic quantization to a whole model can bedone with a single call to torch.quantization.quantize\_dynamic().See the <strong>*tutorial-link-here*</strong>\ <a href="#id1"><span class="problematic" id="id2">*</span></a>. <a href="#id3"><span class="problematic" id="id4">*</span></a></p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Post Training Quantization: This is the most commonly used form ofquantization where the weights are quantized ahead of time and thescale factor and bias for the activation tensors is pre-computedbased on observing the behavior of the model during a calibrationprocess. Post Training Quantization is typically when both memory bandwidth and computesavings are important with CNNs being a typical use case.The general process for doing post training quantization is:</p></li>
</ol>
<div class="section" id="id5">
<h1><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h1>
<dl class="simple">
<dt></dt><dd><ol class="arabic simple">
<li><p>Prepare the model:a. Specify where the activations are quantized and dequantized explicitly by adding QuantStub and DeQuantStub modules.b. Ensure that modules are not reused.c. Convert any operations that require requantization into modules</p></li>
<li><p>Fuse operations like conv + relu or conv+batchnorm + relu together to improve both model accuracy and performance.</p></li>
</ol>
</dd>
</dl>
<dl class="simple">
<dt></dt><dd><ol class="arabic simple" start="3">
<li><p>Specify the configuration of the quantization methods ‘97 such asselecting symmetric or asymmetric quantization and MinMax orL2Norm calibration techniques.</p></li>
<li><p>Use the torch.quantization.prepare() method to insert modulesthat will observe activation tensors during calibration</p></li>
<li><p>Calibrate the model by running inference against a calibrationdataset</p></li>
<li><p>Finally, convert the model itself with thetorch.quantization.convert() method. This does several things: itquantizes the weights, computes and stores the scale and biasvalue to be used each activation tensor, and replaces keyoperators quantized implementations.</p></li>
<li><p>See the <strong>*tutorial-link-here *</strong>\ for more information\ <a href="#id6"><span class="problematic" id="id7">*</span></a>. <a href="#id8"><span class="problematic" id="id9">*</span></a></p></li>
</ol>
</dd>
</dl>
<p>3. Quantization Aware Training: In the rare cases where post training</p>
<blockquote>
<div><p>quantization does not provide adequate accuracy training can be donewith simulated quantization using the <strong>FakeQuant</strong>\ (). Computationswill take place in FP32 but with values clamped and rounded tosimulate the effects of INT8 quantization. The sequence of steps isvery similar.</p>
</div></blockquote>
</div>
<div class="section" id="id10">
<h1><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><ol class="arabic simple">
<li><p>Steps (1) and (2) are identical.</p></li>
</ol>
</div></blockquote>
<dl class="simple">
<dt></dt><dd><ol class="arabic simple" start="3">
<li><p>Specify the configuration of the fake quantization methods ‘97 such asselecting symmetric or asymmetric quantization and MinMax or Moving Averageor L2Norm calibration techniques.</p></li>
<li><p>Use the torch.quantization.prepare_qat() method to insert modulesthat will simulate quantization during training.</p></li>
<li><p>Train or fine tune the model.</p></li>
<li><p>Identical to step (6) for post training quantization</p></li>
</ol>
</dd>
</dl>
<dl class="simple">
<dt></dt><dd><ol class="arabic simple" start="7">
<li><p>See the <strong>*tutorial-link-here *</strong>\ for more information\ <a href="#id11"><span class="problematic" id="id12">*</span></a>. <a href="#id13"><span class="problematic" id="id14">*</span></a></p></li>
</ol>
</dd>
</dl>
<p>While default implementations of observers to select the scale factor and biasbased on observed tensor data are provided, developers can provide their ownquantization functions. Quantization can be applied selectively to differentparts of the model or configured differently for different parts of the model.We also provide support for per channel quantization for <strong>conv2d</strong>\ ()and <strong>linear</strong>\ ()Quantization workflows work by adding (e.g. adding observers as<code class="docutils literal notranslate"><span class="pre">.observer</span></code> submodule) or replacing (e.g. converting <code class="docutils literal notranslate"><span class="pre">nn.Conv2d</span></code> to<code class="docutils literal notranslate"><span class="pre">nn.quantized.Conv2d</span></code>) submodules in the model’s module hierarchy. Itmeans that the model stays a regular <code class="docutils literal notranslate"><span class="pre">nn.Module</span></code>-based instance throughout theprocess and thus can work with the rest of PyTorch APIs.Model preparation for quantization~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~TODO:- fusion- replacement of modules with FloatFunctional- QuantStubCode Structure————–The code is organized into the following modules[Note: Insert quantization code stack diagram here]-  <code class="docutils literal notranslate"><span class="pre">torch.quantization</span></code> : this module implements the functions you call</p>
<blockquote>
<div><p>directly to convert your model from FP32 to quantized form. Forexample the <strong>prepare() **\ method is used in post trainingquantization to prepares your model for the calibration step and the**convert()</strong> method actually converts the weights to int8 andreplaces the operations with their quantized counterparts. There areother helper functions for things like quantizing the input to yourmodel and performing critical fusions like conv+relu.</p>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">torch.nn.quantized</span></code>: This module implements the quantizedimplementations of the nn functions such as <strong>conv2d()</strong> and<strong>ReLU()</strong>. It also contains the functions to convert tensors to andfrom quantized form.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">torch.nn.qat.modules</span></code>: This module implements versions of the key nnmodules <strong>Conv2d</strong>\ () and <strong>Linear</strong>\ () which will run in FP32but with rounding applied to simulate the effect of INT8quantization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">torch.nn.intrinsic.modules</span></code>: This module implements the combined (fused)modules conv + relu which are later quantized.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">torch.nn.intrinsic.quantized.modules</span></code>: This module implements thequantized implementations of fused operations like conv + relu.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">torch.nn.intrinsic.qat.modules</span></code>: This module implements the versionsof those fused operations needed for quantization aware training.</p></li>
</ul>
<p></p>
<p>torch.quantization—————————.. automodule:: torch.quantization</p>
<div class="section" id="fake-quantize">
<h2>Fake Quantize<a class="headerlink" href="#fake-quantize" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="fuse-modules">
<h2>Fuse Modules<a class="headerlink" href="#fuse-modules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="observer">
<h2>Observer<a class="headerlink" href="#observer" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="observer-base">
<h2>Observer Base<a class="headerlink" href="#observer-base" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="min-max-observer">
<h2>Min Max Observer<a class="headerlink" href="#min-max-observer" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="per-channel-min-max-observer">
<h2>Per Channel Min Max Observer<a class="headerlink" href="#per-channel-min-max-observer" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="histogram-observer">
<h2>Histogram Observer<a class="headerlink" href="#histogram-observer" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="recording-observer">
<h2>Recording Observer<a class="headerlink" href="#recording-observer" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="noop-observer">
<h2>Noop Observer<a class="headerlink" href="#noop-observer" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="quant-stub">
<h2>Quant Stub<a class="headerlink" href="#quant-stub" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="dequant-stub">
<h2>DeQuant Stub<a class="headerlink" href="#dequant-stub" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="quant-wrapper">
<h2>Quant Wrapper<a class="headerlink" href="#quant-wrapper" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="utility-functions">
<h2>Utility Functions<a class="headerlink" href="#utility-functions" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-torch.nn.intrinsic.qat.modules">
<span id="torch-nn-instrinsic-qat-modules"></span><h2>torch.nn.instrinsic.qat.modules<a class="headerlink" href="#module-torch.nn.intrinsic.qat.modules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="convbn2d">
<h2>ConvBn2d<a class="headerlink" href="#convbn2d" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.intrinsic.qat.modules.ConvBn2d">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.intrinsic.qat.modules.</code><code class="sig-name descname">ConvBn2d</code><span class="sig-paren">(</span><em class="sig-param">in_channels</em>, <em class="sig-param">out_channels</em>, <em class="sig-param">kernel_size</em>, <em class="sig-param">stride=1</em>, <em class="sig-param">padding=0</em>, <em class="sig-param">dilation=1</em>, <em class="sig-param">groups=1</em>, <em class="sig-param">padding_mode='zeros'</em>, <em class="sig-param">eps=1e-05</em>, <em class="sig-param">momentum=0.1</em>, <em class="sig-param">freeze_bn=False</em>, <em class="sig-param">qconfig=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/intrinsic/qat/modules/conv_fused.html#ConvBn2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.intrinsic.qat.modules.ConvBn2d" title="Permalink to this definition">¶</a></dt>
<dd><p>A ConvBn2d module is a module fused from Conv2d and BatchNorm2d,
attached with FakeQuantize modules for both output activation and weight,
used in quantization aware training.</p>
<p>We combined the interface of <a class="reference internal" href="nn.html#torch.nn.Conv2d" title="torch.nn.Conv2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Conv2d</span></code></a> and
<a class="reference internal" href="nn.html#torch.nn.BatchNorm2d" title="torch.nn.BatchNorm2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.BatchNorm2d</span></code></a>.</p>
<p>Implementation details: <a class="reference external" href="https://arxiv.org/pdf/1806.08342.pdf">https://arxiv.org/pdf/1806.08342.pdf</a> section 3.2.2</p>
<p>Similar to <a class="reference internal" href="nn.html#torch.nn.Conv2d" title="torch.nn.Conv2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Conv2d</span></code></a>, with FakeQuantize modules initialized
to default.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>~ConvBn2d.freeze_bn</strong> – </p></li>
<li><p><strong>~ConvBn2d.observer</strong> – fake quant module for output activation, it’s called observer
to align with post training flow</p></li>
<li><p><strong>~ConvBn2d.weight_fake_quant</strong> – fake quant module for weight</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="torch.nn.intrinsic.qat.modules.ConvBn2d.from_float">
<em class="property">classmethod </em><code class="sig-name descname">from_float</code><span class="sig-paren">(</span><em class="sig-param">mod</em>, <em class="sig-param">qconfig=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/intrinsic/qat/modules/conv_fused.html#ConvBn2d.from_float"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.intrinsic.qat.modules.ConvBn2d.from_float" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a qat module from a float module or qparams_dict</p>
<p>Args: <cite>mod</cite> a float module, either produced by torch.quantization utilities
or directly from user</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="convbnrelu2d">
<h2>ConvBnReLU2d<a class="headerlink" href="#convbnrelu2d" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.intrinsic.qat.modules.ConvBnReLU2d">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.intrinsic.qat.modules.</code><code class="sig-name descname">ConvBnReLU2d</code><span class="sig-paren">(</span><em class="sig-param">in_channels</em>, <em class="sig-param">out_channels</em>, <em class="sig-param">kernel_size</em>, <em class="sig-param">stride=1</em>, <em class="sig-param">padding=0</em>, <em class="sig-param">dilation=1</em>, <em class="sig-param">groups=1</em>, <em class="sig-param">padding_mode='zeros'</em>, <em class="sig-param">eps=1e-05</em>, <em class="sig-param">momentum=0.1</em>, <em class="sig-param">freeze_bn=False</em>, <em class="sig-param">qconfig=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/intrinsic/qat/modules/conv_fused.html#ConvBnReLU2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.intrinsic.qat.modules.ConvBnReLU2d" title="Permalink to this definition">¶</a></dt>
<dd><p>A ConvBnReLU2d module is a module fused from Conv2d, BatchNorm2d and ReLU,
attached with FakeQuantize modules for both output activation and weight,
used in quantization aware training.</p>
<p>We combined the interface of <a class="reference internal" href="nn.html#torch.nn.Conv2d" title="torch.nn.Conv2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Conv2d</span></code></a> and
<a class="reference internal" href="nn.html#torch.nn.BatchNorm2d" title="torch.nn.BatchNorm2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.BatchNorm2d</span></code></a> and <a class="reference internal" href="nn.html#torch.nn.ReLU" title="torch.nn.ReLU"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.ReLU</span></code></a>.</p>
<p>Implementation details: <a class="reference external" href="https://arxiv.org/pdf/1806.08342.pdf">https://arxiv.org/pdf/1806.08342.pdf</a></p>
<p>Similar to <cite>torch.nn.Conv2d</cite>, with FakeQuantize modules initialized to
default.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>~ConvBnReLU2d.observer</strong> – fake quant module for output activation, it’s called observer
to align with post training flow</p></li>
<li><p><strong>~ConvBnReLU2d.weight_fake_quant</strong> – fake quant module for weight</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="convrelu2d">
<h2>ConvReLU2d<a class="headerlink" href="#convrelu2d" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.intrinsic.qat.modules.ConvReLU2d">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.intrinsic.qat.modules.</code><code class="sig-name descname">ConvReLU2d</code><span class="sig-paren">(</span><em class="sig-param">in_channels</em>, <em class="sig-param">out_channels</em>, <em class="sig-param">kernel_size</em>, <em class="sig-param">stride=1</em>, <em class="sig-param">padding=0</em>, <em class="sig-param">dilation=1</em>, <em class="sig-param">groups=1</em>, <em class="sig-param">bias=True</em>, <em class="sig-param">padding_mode='zeros'</em>, <em class="sig-param">qconfig=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/intrinsic/qat/modules/conv_fused.html#ConvReLU2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.intrinsic.qat.modules.ConvReLU2d" title="Permalink to this definition">¶</a></dt>
<dd><p>A ConvReLU2d module is a fused module of Conv2d and ReLU, attached with
FakeQuantize modules for both output activation and weight for
quantization aware training.</p>
<p>We combined the interface of <a class="reference internal" href="nn.html#torch.nn.Conv2d" title="torch.nn.Conv2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">Conv2d</span></code></a> and
<a class="reference internal" href="nn.html#torch.nn.BatchNorm2d" title="torch.nn.BatchNorm2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">BatchNorm2d</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>~ConvReLU2d.observer</strong> – fake quant module for output activation, it’s called observer
to align with post training flow</p></li>
<li><p><strong>~ConvReLU2d.weight_fake_quant</strong> – fake quant module for weight</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="linearrelu">
<h2>LinearReLU<a class="headerlink" href="#linearrelu" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.intrinsic.qat.modules.LinearReLU">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.intrinsic.qat.modules.</code><code class="sig-name descname">LinearReLU</code><span class="sig-paren">(</span><em class="sig-param">in_features</em>, <em class="sig-param">out_features</em>, <em class="sig-param">bias=True</em>, <em class="sig-param">qconfig=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/intrinsic/qat/modules/linear_relu.html#LinearReLU"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.intrinsic.qat.modules.LinearReLU" title="Permalink to this definition">¶</a></dt>
<dd><p>A LinearReLU module fused from Linear and ReLU modules, attached with
FakeQuantize modules for output activation and weight, used in
quantization aware training.</p>
<p>We adopt the same interface as <a class="reference internal" href="nn.html#torch.nn.Linear" title="torch.nn.Linear"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Linear</span></code></a>.</p>
<p>Similar to <cite>torch.nn.intrinsic.LinearReLU</cite>, with FakeQuantize modules initialized to
default.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>~LinearReLU.observer</strong> – fake quant module for output activation, it’s called observer
to align with post training flow, TODO: rename?</p></li>
<li><p><strong>~LinearReLU.weight</strong> – fake quant module for weight</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">qat</span><span class="o">.</span><span class="n">LinearReLU</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<span class="go">torch.Size([128, 30])</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-torch.nn.intrinsic.quantized.modules">
<span id="torch-nn-intrinsic-quantized-modules"></span><h2>torch.nn.intrinsic.quantized.modules<a class="headerlink" href="#module-torch.nn.intrinsic.quantized.modules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="id15">
<h2>ConvReLU2d<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.intrinsic.quantized.modules.ConvReLU2d">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.intrinsic.quantized.modules.</code><code class="sig-name descname">ConvReLU2d</code><span class="sig-paren">(</span><em class="sig-param">in_channels</em>, <em class="sig-param">out_channels</em>, <em class="sig-param">kernel_size</em>, <em class="sig-param">stride=1</em>, <em class="sig-param">padding=0</em>, <em class="sig-param">dilation=1</em>, <em class="sig-param">groups=1</em>, <em class="sig-param">bias=True</em>, <em class="sig-param">padding_mode='zeros'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/intrinsic/quantized/modules/conv_relu.html#ConvReLU2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.intrinsic.quantized.modules.ConvReLU2d" title="Permalink to this definition">¶</a></dt>
<dd><p>A ConvReLU2d module is a fused module of Conv2d and ReLU</p>
<p>We adopt the same interface as <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.quantized.Conv2d</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><strong>as torch.nn.quantized.Conv2d</strong> (<em>Same</em>) – </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id16">
<h2>LinearReLU<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.intrinsic.quantized.modules.LinearReLU">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.intrinsic.quantized.modules.</code><code class="sig-name descname">LinearReLU</code><span class="sig-paren">(</span><em class="sig-param">in_features</em>, <em class="sig-param">out_features</em>, <em class="sig-param">bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/intrinsic/quantized/modules/linear_relu.html#LinearReLU"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.intrinsic.quantized.modules.LinearReLU" title="Permalink to this definition">¶</a></dt>
<dd><p>A LinearReLU module fused from Linear and ReLU modules</p>
<p>We adopt the same interface as <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.quantized.Linear</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><strong>as torch.nn.quantized.Linear</strong> (<em>Same</em>) – </p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">intrinsic</span><span class="o">.</span><span class="n">LinearReLU</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<span class="go">torch.Size([128, 30])</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-torch.nn.qat.modules">
<span id="torch-nn-qat-modules"></span><h2>torch.nn.qat.modules<a class="headerlink" href="#module-torch.nn.qat.modules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="conv2d">
<h2>Conv2d<a class="headerlink" href="#conv2d" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.qat.modules.Conv2d">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.qat.modules.</code><code class="sig-name descname">Conv2d</code><span class="sig-paren">(</span><em class="sig-param">in_channels</em>, <em class="sig-param">out_channels</em>, <em class="sig-param">kernel_size</em>, <em class="sig-param">stride=1</em>, <em class="sig-param">padding=0</em>, <em class="sig-param">dilation=1</em>, <em class="sig-param">groups=1</em>, <em class="sig-param">bias=True</em>, <em class="sig-param">padding_mode='zeros'</em>, <em class="sig-param">qconfig=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/qat/modules/conv.html#Conv2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.qat.modules.Conv2d" title="Permalink to this definition">¶</a></dt>
<dd><p>A Conv2d module attached with FakeQuantize modules for both output
activation and weight, used for quantization aware training.</p>
<p>We adopt the same interface as <cite>torch.nn.Conv2d</cite>, please see
<a class="reference external" href="https://pytorch.org/docs/stable/nn.html?highlight=conv2d#torch.nn.Conv2d">https://pytorch.org/docs/stable/nn.html?highlight=conv2d#torch.nn.Conv2d</a>
for documentation.</p>
<p>Similar to <cite>torch.nn.Conv2d</cite>, with FakeQuantize modules initialized to
default.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>~Conv2d.observer</strong> – fake quant module for output activation, it’s called observer
to align with post training flow</p></li>
<li><p><strong>~Conv2d.weight_fake_quant</strong> – fake quant module for weight</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="torch.nn.qat.modules.Conv2d.from_float">
<em class="property">classmethod </em><code class="sig-name descname">from_float</code><span class="sig-paren">(</span><em class="sig-param">mod</em>, <em class="sig-param">qconfig=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/qat/modules/conv.html#Conv2d.from_float"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.qat.modules.Conv2d.from_float" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a qat module from a float module or qparams_dict</p>
<p>Args: <cite>mod</cite> a float module, either produced by torch.quantization utilities
or directly from user</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="linear">
<h2>Linear<a class="headerlink" href="#linear" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.qat.modules.Linear">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.qat.modules.</code><code class="sig-name descname">Linear</code><span class="sig-paren">(</span><em class="sig-param">in_features</em>, <em class="sig-param">out_features</em>, <em class="sig-param">bias=True</em>, <em class="sig-param">qconfig=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/qat/modules/linear.html#Linear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.qat.modules.Linear" title="Permalink to this definition">¶</a></dt>
<dd><p>A linear module attached with FakeQuantize modules for both output
activation and weight, used for quantization aware training.</p>
<p>We adopt the same interface as <cite>torch.nn.Linear</cite>, please see
<a class="reference external" href="https://pytorch.org/docs/stable/nn.html#torch.nn.Linear">https://pytorch.org/docs/stable/nn.html#torch.nn.Linear</a>
for documentation.</p>
<p>Similar to <cite>torch.nn.Linear</cite>, with FakeQuantize modules initialized to
default.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>~Linear.observer</strong> – fake quant module for output activation, it’s called observer
to align with post training flow</p></li>
<li><p><strong>~Linear.weight</strong> – fake quant module for weight</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="torch.nn.qat.modules.Linear.from_float">
<em class="property">classmethod </em><code class="sig-name descname">from_float</code><span class="sig-paren">(</span><em class="sig-param">mod</em>, <em class="sig-param">qconfig=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/qat/modules/linear.html#Linear.from_float"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.qat.modules.Linear.from_float" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a qat module from a float module or qparams_dict</p>
<p>Args: <cite>mod</cite> a float module, either produced by torch.quantization utilities
or directly from user</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-torch.nn.quantized.functional">
<span id="torch-nn-quantized"></span><h2>torch.nn.quantized<a class="headerlink" href="#module-torch.nn.quantized.functional" title="Permalink to this headline">¶</a></h2>
<p>Functional interface (quantized).</p>
</div>
<div class="section" id="functional-interface">
<h2>Functional interface<a class="headerlink" href="#functional-interface" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="torch.nn.quantized.functional.relu">
<code class="sig-prename descclassname">torch.nn.quantized.functional.</code><code class="sig-name descname">relu</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">inplace=False</em><span class="sig-paren">)</span> &#x2192; Tensor<a class="reference internal" href="_modules/torch/nn/quantized/functional.html#relu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.quantized.functional.relu" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the rectified linear unit function element-wise. See
<a class="reference internal" href="nn.html#torch.nn.ReLU" title="torch.nn.ReLU"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReLU</span></code></a> for more details.</p>
</dd></dl>

<dl class="function">
<dt id="torch.nn.quantized.functional.linear">
<code class="sig-prename descclassname">torch.nn.quantized.functional.</code><code class="sig-name descname">linear</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">weight</em>, <em class="sig-param">bias=None</em>, <em class="sig-param">scale=None</em>, <em class="sig-param">zero_point=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/quantized/functional.html#linear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.quantized.functional.linear" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a linear transformation to the incoming quantized data:
<span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi><msup><mi>A</mi><mi>T</mi></msup><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">y = xA^T + b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.035771em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mrel">=</span><span class="mord mathit">x</span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mbin">+</span><span class="mord mathit">b</span></span></span></span>
</span>.
See <a class="reference internal" href="nn.html#torch.nn.Linear" title="torch.nn.Linear"><code class="xref py py-class docutils literal notranslate"><span class="pre">Linear</span></code></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Current implementation uses packed weights. This has penalty on performance.
If you want to avoid the overhead, use <code class="xref py py-class docutils literal notranslate"><span class="pre">Linear</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – Quantized input of type <cite>torch.quint8</cite></p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – Quantized weight of type <cite>torch.qint8</cite></p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – None or fp32 bias of type <cite>torch.float</cite></p></li>
<li><p><strong>scale</strong> (<em>double</em>) – output scale. If None, derived from the input scale</p></li>
<li><p><strong>zero_point</strong> (<em>long</em>) – output zero point. If None, derived from the input zero_point</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><p>Input: <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>N</mi><mo separator="true">,</mo><mo>∗</mo><mo separator="true">,</mo><mi>i</mi><mi>n</mi><mi mathvariant="normal">_</mi><mi>f</mi><mi>e</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(N, *, in\_features)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.06em;vertical-align:-0.31em;"></span><span class="base"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mord">∗</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">e</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span>
</span> where <cite>*</cite> means any number of
additional dimensions</p></li>
<li><p>Weight: <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>f</mi><mi>e</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>s</mi><mo separator="true">,</mo><mi>i</mi><mi>n</mi><mi mathvariant="normal">_</mi><mi>f</mi><mi>e</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(out\_features, in\_features)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.06em;vertical-align:-0.31em;"></span><span class="base"><span class="mopen">(</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">t</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">e</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">e</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span>
</span></p></li>
<li><p>Bias: <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>f</mi><mi>e</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(out\_features)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.06em;vertical-align:-0.31em;"></span><span class="base"><span class="mopen">(</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">t</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">e</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span>
</span></p></li>
<li><p>Output: <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>N</mi><mo separator="true">,</mo><mo>∗</mo><mo separator="true">,</mo><mi>o</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>f</mi><mi>e</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(N, *, out\_features)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.06em;vertical-align:-0.31em;"></span><span class="base"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mord">∗</span><span class="mpunct">,</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">t</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">e</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">s</span><span class="mclose">)</span></span></span></span>
</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="torch.nn.quantized.functional.conv2d">
<code class="sig-prename descclassname">torch.nn.quantized.functional.</code><code class="sig-name descname">conv2d</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">weight</em>, <em class="sig-param">bias</em>, <em class="sig-param">stride=1</em>, <em class="sig-param">padding=0</em>, <em class="sig-param">dilation=1</em>, <em class="sig-param">groups=1</em>, <em class="sig-param">padding_mode='zeros'</em>, <em class="sig-param">scale=1.0</em>, <em class="sig-param">zero_point=0</em>, <em class="sig-param">dtype=torch.quint8</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/quantized/functional.html#conv2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.quantized.functional.conv2d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>conv2d(input, weight, bias,</dt><dd><p>stride=1, padding=0, dilation=1, groups=1,
padding_mode=’zeros’,
scale=1.0, zero_point=0,
dtype=torch.quint8) -&gt; Tensor</p>
</dd>
</dl>
<p>Applies a 2D convolution over a quantized 2D input composed of several input
planes.</p>
<p>See <a class="reference internal" href="nn.html#torch.nn.Conv2d" title="torch.nn.Conv2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">Conv2d</span></code></a> for details and output shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> – quantized input tensor of shape <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mtext>minibatch</mtext><mo separator="true">,</mo><mtext>in_channels</mtext><mo separator="true">,</mo><mi>i</mi><mi>H</mi><mo separator="true">,</mo><mi>i</mi><mi>W</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(\text{minibatch} , \text{in\_channels} , iH , iW)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.06em;vertical-align:-0.31em;"></span><span class="base"><span class="mopen">(</span><span class="mord text"><span class="mord mathrm">minibatch</span></span><span class="mpunct">,</span><span class="mord text"><span class="mord mathrm">in_channels</span></span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span>
</span></p></li>
<li><p><strong>weight</strong> – quantized filters of shape <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mtext>out_channels</mtext><mo separator="true">,</mo><mfrac><mrow><mtext>in_channels</mtext></mrow><mrow><mtext>groups</mtext></mrow></mfrac><mo separator="true">,</mo><mi>k</mi><mi>H</mi><mo separator="true">,</mo><mi>k</mi><mi>W</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(\text{out\_channels} , \frac{\text{in\_channels}}{\text{groups}} , kH , kW)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.013108em;"></span><span class="strut bottom" style="height:1.4942159999999998em;vertical-align:-0.481108em;"></span><span class="base"><span class="mopen">(</span><span class="mord text"><span class="mord mathrm">out_channels</span></span><span class="mpunct">,</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.013108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mathrm mtight">groups</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.527em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mathrm mtight">in_channels</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span>
</span></p></li>
<li><p><strong>bias</strong> – <strong>non-quantized</strong> bias tensor of shape <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mtext>out_channels</mtext><mo>)</mo></mrow><annotation encoding="application/x-tex">(\text{out\_channels})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.06em;vertical-align:-0.31em;"></span><span class="base"><span class="mopen">(</span><span class="mord text"><span class="mord mathrm">out_channels</span></span><span class="mclose">)</span></span></span></span>
</span>. The tensor type must be <cite>torch.float</cite>.</p></li>
<li><p><strong>stride</strong> – the stride of the convolving kernel. Can be a single number or a
tuple <cite>(sH, sW)</cite>. Default: 1</p></li>
<li><p><strong>padding</strong> – implicit paddings on both sides of the input. Can be a
single number or a tuple <cite>(padH, padW)</cite>. Default: 0</p></li>
<li><p><strong>dilation</strong> – the spacing between kernel elements. Can be a single number or
a tuple <cite>(dH, dW)</cite>. Default: 1</p></li>
<li><p><strong>groups</strong> – split input into groups, <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>in_channels</mtext></mrow><annotation encoding="application/x-tex">\text{in\_channels}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:1.00444em;vertical-align:-0.31em;"></span><span class="base"><span class="mord text"><span class="mord mathrm">in_channels</span></span></span></span></span>
</span> should be divisible by the
number of groups. Default: 1</p></li>
<li><p><strong>padding_mode</strong> – the padding mode to use. Only “zeros” is supported for quantized convolution at the moment. Default: “zeros”</p></li>
<li><p><strong>scale</strong> – quantization scale for the output. Default: 1.0</p></li>
<li><p><strong>zero_point</strong> – quantization zero_point for the output. Default: 0</p></li>
<li><p><strong>dtype</strong> – quantization data type to use. Default: <code class="docutils literal notranslate"><span class="pre">torch.quint8</span></code></p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">torch.nn.quantized</span> <span class="k">import</span> <span class="n">functional</span> <span class="k">as</span> <span class="n">qF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filters</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bias</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span><span class="p">,</span> <span class="n">zero_point</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">quint8</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q_filters</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">quantize_per_tensor</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">zero_point</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q_inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">quantize_per_tensor</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">zero_point</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qF</span><span class="o">.</span><span class="n">conv2d</span><span class="p">(</span><span class="n">q_inputs</span><span class="p">,</span> <span class="n">q_filters</span><span class="p">,</span> <span class="n">bias</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">zero_point</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="torch.nn.quantized.functional.max_pool2d">
<code class="sig-prename descclassname">torch.nn.quantized.functional.</code><code class="sig-name descname">max_pool2d</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">kernel_size</em>, <em class="sig-param">stride=None</em>, <em class="sig-param">padding=0</em>, <em class="sig-param">dilation=1</em>, <em class="sig-param">ceil_mode=False</em>, <em class="sig-param">return_indices=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/quantized/functional.html#max_pool2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.quantized.functional.max_pool2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a 2D max pooling over a quantized input signal composed of
several quantized input planes.</p>
<p>See <code class="xref py py-class docutils literal notranslate"><span class="pre">MaxPool2d</span></code> for details.</p>
</dd></dl>

<span class="target" id="module-torch.nn.quantized.dynamic.modules"></span></div>
<div class="section" id="id17">
<h2>Linear<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.quantized.dynamic.modules.Linear">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.quantized.dynamic.modules.</code><code class="sig-name descname">Linear</code><span class="sig-paren">(</span><em class="sig-param">in_features</em>, <em class="sig-param">out_features</em>, <em class="sig-param">bias_=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/quantized/dynamic/modules/linear.html#Linear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.quantized.dynamic.modules.Linear" title="Permalink to this definition">¶</a></dt>
<dd><p>A dynamic quantized linear module with quantized tensor as inputs and outputs.
We adopt the same interface as <cite>torch.nn.Linear</cite>, please see
<a class="reference external" href="https://pytorch.org/docs/stable/nn.html#torch.nn.Linear">https://pytorch.org/docs/stable/nn.html#torch.nn.Linear</a> for documentation.</p>
<p>Similar to <a class="reference internal" href="nn.html#torch.nn.Linear" title="torch.nn.Linear"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Linear</span></code></a>, attributes will be randomly
initialized at module creation time and will be overwritten later</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>~Linear.weight</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – the non-learnable quantized weights of the module which are of
shape <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mtext>out_features</mtext><mo separator="true">,</mo><mtext>in_features</mtext><mo>)</mo></mrow><annotation encoding="application/x-tex">(\text{out\_features}, \text{in\_features})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.06em;vertical-align:-0.31em;"></span><span class="base"><span class="mopen">(</span><span class="mord text"><span class="mord mathrm">out_features</span></span><span class="mpunct">,</span><span class="mord text"><span class="mord mathrm">in_features</span></span><span class="mclose">)</span></span></span></span>
</span>.</p></li>
<li><p><strong>~Linear.bias</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – the non-learnable bias of the module of shape <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mtext>out_features</mtext><mo>)</mo></mrow><annotation encoding="application/x-tex">(\text{out\_features})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.06em;vertical-align:-0.31em;"></span><span class="base"><span class="mopen">(</span><span class="mord text"><span class="mord mathrm">out_features</span></span><span class="mclose">)</span></span></span></span>
</span>.
If <code class="xref py py-attr docutils literal notranslate"><span class="pre">bias</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the values are initialized to zero.</p></li>
<li><p><strong>~Linear.scale</strong> – <cite>scale</cite> parameter of weight Quantized Tensor, type: double</p></li>
<li><p><strong>~Linear.zero_point</strong> – <cite>zero_point</cite> parameter for weight Quantized Tensor, type: long</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">quantized</span><span class="o">.</span><span class="n">dynamic</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<span class="go">torch.Size([128, 30])</span>
</pre></div>
</div>
<dl class="method">
<dt id="torch.nn.quantized.dynamic.modules.Linear.from_float">
<em class="property">classmethod </em><code class="sig-name descname">from_float</code><span class="sig-paren">(</span><em class="sig-param">mod</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/quantized/dynamic/modules/linear.html#Linear.from_float"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.quantized.dynamic.modules.Linear.from_float" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a dynamic quantized module from a float module or qparams_dict</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mod</strong> (<a class="reference internal" href="nn.html#torch.nn.Module" title="torch.nn.Module"><em>Module</em></a>) – a float module, either produced by torch.quantization
utilities or provided by the user</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-torch.nn.quantized.modules.activation">
<span id="rnnbase"></span><h2>RNNBase<a class="headerlink" href="#module-torch.nn.quantized.modules.activation" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="relu">
<h2>ReLU<a class="headerlink" href="#relu" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.quantized.modules.activation.ReLU">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.quantized.modules.activation.</code><code class="sig-name descname">ReLU</code><span class="sig-paren">(</span><em class="sig-param">inplace=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/quantized/modules/activation.html#ReLU"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.quantized.modules.activation.ReLU" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies quantized rectified linear unit function element-wise:</p>
<p><span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>ReLU</mtext><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mi>max</mi><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator="true">,</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\text{ReLU}(x)= \max(x_0, x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord text"><span class="mord mathrm">ReLU</span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>
</span>, where <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span>
</span> is the zero point.</p>
<p>Please see <a class="reference external" href="https://pytorch.org/docs/stable/nn.html#torch.nn.ReLU">https://pytorch.org/docs/stable/nn.html#torch.nn.ReLU</a>
for more documentation on ReLU.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inplace</strong> – (Currently not supported) can optionally do the operation in-place.</p>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><p>Input: <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>N</mi><mo separator="true">,</mo><mo>∗</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">(N, *)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mord">∗</span><span class="mclose">)</span></span></span></span>
</span> where <cite>*</cite> means, any number of additional
dimensions</p></li>
<li><p>Output: <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>N</mi><mo separator="true">,</mo><mo>∗</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">(N, *)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mord">∗</span><span class="mclose">)</span></span></span></span>
</span>, same shape as the input</p></li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">quantized</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">quantize_per_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">qint32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="relu6">
<h2>ReLU6<a class="headerlink" href="#relu6" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.quantized.modules.activation.ReLU6">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.quantized.modules.activation.</code><code class="sig-name descname">ReLU6</code><span class="sig-paren">(</span><em class="sig-param">inplace=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/quantized/modules/activation.html#ReLU6"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.quantized.modules.activation.ReLU6" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the element-wise function:</p>
<p><span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>ReLU6</mtext><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mi>min</mi><mo>(</mo><mi>max</mi><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator="true">,</mo><mi>x</mi><mo>)</mo><mo separator="true">,</mo><mi>q</mi><mo>(</mo><mn>6</mn><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\text{ReLU6}(x) = \min(\max(x_0, x), q(6))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord text"><span class="mord mathrm">ReLU6</span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop">min</span><span class="mopen">(</span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathrm">6</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>
</span>, where <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span>
</span> is the
zero_point, and <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi><mo>(</mo><mn>6</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">q(6)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathrm">6</span><span class="mclose">)</span></span></span></span>
</span> is the quantized representation of number 6.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inplace</strong> – can optionally do the operation in-place. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><p>Input: <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>N</mi><mo separator="true">,</mo><mo>∗</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">(N, *)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mord">∗</span><span class="mclose">)</span></span></span></span>
</span> where <cite>*</cite> means, any number of additional
dimensions</p></li>
<li><p>Output: <span class="math"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>N</mi><mo separator="true">,</mo><mo>∗</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">(N, *)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mord">∗</span><span class="mclose">)</span></span></span></span>
</span>, same shape as the input</p></li>
</ul>
</dd>
</dl>
<img alt="_images/ReLU6.png" src="_images/ReLU6.png" />
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">quantized</span><span class="o">.</span><span class="n">ReLU6</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">quantize_per_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">qint32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-torch.nn.quantized.modules.conv"></span><p>Quantized convolution modules.</p>
</div>
<div class="section" id="id18">
<h2>Conv2d<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.quantized.modules.conv.Conv2d">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.quantized.modules.conv.</code><code class="sig-name descname">Conv2d</code><span class="sig-paren">(</span><em class="sig-param">in_channels</em>, <em class="sig-param">out_channels</em>, <em class="sig-param">kernel_size</em>, <em class="sig-param">stride=1</em>, <em class="sig-param">padding=0</em>, <em class="sig-param">dilation=1</em>, <em class="sig-param">groups=1</em>, <em class="sig-param">bias=True</em>, <em class="sig-param">padding_mode='zeros'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/quantized/modules/conv.html#Conv2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.quantized.modules.conv.Conv2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a 2D convolution over a quantized input signal composed of
several quantized input planes.</p>
<p>For details on input arguments, parameters, and implementation see
<a class="reference internal" href="nn.html#torch.nn.Conv2d" title="torch.nn.Conv2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">Conv2d</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only <cite>zeros</cite> is supported for the <code class="xref py py-attr docutils literal notranslate"><span class="pre">padding_mode</span></code> argument.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only <cite>torch.quint8</cite> is supported for the input data type.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>~Conv2d.weight</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – packed tensor derived from the learnable weight
parameter.</p></li>
<li><p><strong>~Conv2d.scale</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – scalar for the output scale</p></li>
<li><p><strong>~Conv2d.zero_point</strong> (<a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor"><em>Tensor</em></a>) – scalar for the output zero point</p></li>
</ul>
</dd>
</dl>
<p>See <a class="reference internal" href="nn.html#torch.nn.Conv2d" title="torch.nn.Conv2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">Conv2d</span></code></a> for other attributes.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># With square kernels and equal stride</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">quantized</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># non-square kernels and unequal stride and with padding</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">quantized</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># non-square kernels and unequal stride and with padding and dilation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">quantized</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dilation</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># quantize input to qint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q_input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">quantize_per_tensor</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">zero_point</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">qint32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="torch.nn.quantized.modules.conv.Conv2d.from_float">
<em class="property">classmethod </em><code class="sig-name descname">from_float</code><span class="sig-paren">(</span><em class="sig-param">mod</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/quantized/modules/conv.html#Conv2d.from_float"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.quantized.modules.conv.Conv2d.from_float" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a quantized module from a float module or qparams_dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mod</strong> (<a class="reference internal" href="nn.html#torch.nn.Module" title="torch.nn.Module"><em>Module</em></a>) – a float module, either produced by torch.quantization
utilities or provided by the user</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-torch.nn.quantized.modules.functional_modules"></span></div>
<div class="section" id="float-functional">
<h2>Float Functional<a class="headerlink" href="#float-functional" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.quantized.modules.functional_modules.FloatFunctional">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.quantized.modules.functional_modules.</code><code class="sig-name descname">FloatFunctional</code><a class="reference internal" href="_modules/torch/nn/quantized/modules/functional_modules.html#FloatFunctional"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.quantized.modules.functional_modules.FloatFunctional" title="Permalink to this definition">¶</a></dt>
<dd><p>State collector class for float operatitons.</p>
<p>The instance of this class can be used instead of the <code class="docutils literal notranslate"><span class="pre">torch.</span></code> prefix for
some operations. See example usage below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class does not provide a <code class="docutils literal notranslate"><span class="pre">forward</span></code> hook. Instead, you must use
one of the underlying functions (e.g. <code class="docutils literal notranslate"><span class="pre">add</span></code>).</p>
</div>
<dl class="simple">
<dt>Valid operation names:</dt><dd><ul class="simple">
<li><p>add</p></li>
<li><p>cat</p></li>
<li><p>mul</p></li>
<li><p>add_relu</p></li>
<li><p>add_scalar</p></li>
<li><p>mul_scalar</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="qfunctional">
<h2>QFunctional<a class="headerlink" href="#qfunctional" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.quantized.modules.functional_modules.QFunctional">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.quantized.modules.functional_modules.</code><code class="sig-name descname">QFunctional</code><a class="reference internal" href="_modules/torch/nn/quantized/modules/functional_modules.html#QFunctional"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.quantized.modules.functional_modules.QFunctional" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper class for quantized operatitons.</p>
<p>The instance of this class can be used instead of the
<code class="docutils literal notranslate"><span class="pre">torch.ops.quantized</span></code> prefix. See example usage below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class does not provide a <code class="docutils literal notranslate"><span class="pre">forward</span></code> hook. Instead, you must use
one of the underlying functions (e.g. <code class="docutils literal notranslate"><span class="pre">add</span></code>).</p>
</div>
<dl class="simple">
<dt>Valid operation names:</dt><dd><ul class="simple">
<li><p>add</p></li>
<li><p>cat</p></li>
<li><p>mul</p></li>
<li><p>add_relu</p></li>
<li><p>add_scalar</p></li>
<li><p>mul_scalar</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-torch.nn.quantized.modules.linear"></span></div>
<div class="section" id="quantize">
<h2>Quantize<a class="headerlink" href="#quantize" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.quantized.modules.linear.Quantize">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.quantized.modules.linear.</code><code class="sig-name descname">Quantize</code><span class="sig-paren">(</span><em class="sig-param">scale</em>, <em class="sig-param">zero_point</em>, <em class="sig-param">dtype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torch/nn/quantized/modules/linear.html#Quantize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.quantized.modules.linear.Quantize" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantizes an incoming tensor
:param <cite>out_scale</cite>: scale of the output Quantized Tensor
:param <cite>out_zero_point</cite>: zero_point of output Quantized Tensor
:param <cite>out_dtype</cite>: data type of output Quantized Tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><strong>out_zero_point, out_dtype</strong> (<em>`out_scale`</em><em>,</em>) – </p>
</dd>
</dl>
<dl>
<dt>Examples::</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span><span class="p">,</span> <span class="n">zero_point</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">qint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qm</span> <span class="o">=</span> <span class="n">Quantize</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">zero_point</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qt</span> <span class="o">=</span> <span class="n">qm</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">qt</span><span class="p">)</span>
<span class="go">tensor([[ 1., -1.],</span>
<span class="go">        [ 1., -1.]], size=(2, 2), dtype=torch.qint8, scale=1.0, zero_point=2)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="dequantize">
<h2>DeQuantize<a class="headerlink" href="#dequantize" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="torch.nn.quantized.modules.linear.DeQuantize">
<em class="property">class </em><code class="sig-prename descclassname">torch.nn.quantized.modules.linear.</code><code class="sig-name descname">DeQuantize</code><a class="reference internal" href="_modules/torch/nn/quantized/modules/linear.html#DeQuantize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torch.nn.quantized.modules.linear.DeQuantize" title="Permalink to this definition">¶</a></dt>
<dd><p>Dequantizes an incoming tensor</p>
<dl>
<dt>Examples::</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span><span class="p">,</span> <span class="n">zero_point</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">qint8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qm</span> <span class="o">=</span> <span class="n">Quantize</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">zero_point</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quantized_input</span> <span class="o">=</span> <span class="n">qm</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dqm</span> <span class="o">=</span> <span class="n">DeQuantize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dequantized</span> <span class="o">=</span> <span class="n">dqm</span><span class="p">(</span><span class="n">quantized_input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dequantized</span><span class="p">)</span>
<span class="go">tensor([[ 1., -1.],</span>
<span class="go">        [ 1., -1.]], dtype=torch.float32)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id19">
<h2>Linear<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h2>
</div>
</div>


             </article>
             
            </div>
            <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Torch Contributors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#"></a></li>
<li><a class="reference internal" href="#id10"></a><ul>
<li><a class="reference internal" href="#fake-quantize">Fake Quantize</a></li>
<li><a class="reference internal" href="#fuse-modules">Fuse Modules</a></li>
<li><a class="reference internal" href="#observer">Observer</a></li>
<li><a class="reference internal" href="#observer-base">Observer Base</a></li>
<li><a class="reference internal" href="#min-max-observer">Min Max Observer</a></li>
<li><a class="reference internal" href="#per-channel-min-max-observer">Per Channel Min Max Observer</a></li>
<li><a class="reference internal" href="#histogram-observer">Histogram Observer</a></li>
<li><a class="reference internal" href="#recording-observer">Recording Observer</a></li>
<li><a class="reference internal" href="#noop-observer">Noop Observer</a></li>
<li><a class="reference internal" href="#quant-stub">Quant Stub</a></li>
<li><a class="reference internal" href="#dequant-stub">DeQuant Stub</a></li>
<li><a class="reference internal" href="#quant-wrapper">Quant Wrapper</a></li>
<li><a class="reference internal" href="#utility-functions">Utility Functions</a></li>
<li><a class="reference internal" href="#module-torch.nn.intrinsic.qat.modules">torch.nn.instrinsic.qat.modules</a></li>
<li><a class="reference internal" href="#convbn2d">ConvBn2d</a></li>
<li><a class="reference internal" href="#convbnrelu2d">ConvBnReLU2d</a></li>
<li><a class="reference internal" href="#convrelu2d">ConvReLU2d</a></li>
<li><a class="reference internal" href="#linearrelu">LinearReLU</a></li>
<li><a class="reference internal" href="#module-torch.nn.intrinsic.quantized.modules">torch.nn.intrinsic.quantized.modules</a></li>
<li><a class="reference internal" href="#id15">ConvReLU2d</a></li>
<li><a class="reference internal" href="#id16">LinearReLU</a></li>
<li><a class="reference internal" href="#module-torch.nn.qat.modules">torch.nn.qat.modules</a></li>
<li><a class="reference internal" href="#conv2d">Conv2d</a></li>
<li><a class="reference internal" href="#linear">Linear</a></li>
<li><a class="reference internal" href="#module-torch.nn.quantized.functional">torch.nn.quantized</a></li>
<li><a class="reference internal" href="#functional-interface">Functional interface</a></li>
<li><a class="reference internal" href="#id17">Linear</a></li>
<li><a class="reference internal" href="#module-torch.nn.quantized.modules.activation">RNNBase</a></li>
<li><a class="reference internal" href="#relu">ReLU</a></li>
<li><a class="reference internal" href="#relu6">ReLU6</a></li>
<li><a class="reference internal" href="#id18">Conv2d</a></li>
<li><a class="reference internal" href="#float-functional">Float Functional</a></li>
<li><a class="reference internal" href="#qfunctional">QFunctional</a></li>
<li><a class="reference internal" href="#quantize">Quantize</a></li>
<li><a class="reference internal" href="#dequantize">DeQuantize</a></li>
<li><a class="reference internal" href="#id19">Linear</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script type="text/javascript" src="_static/jquery.js"></script>
         <script type="text/javascript" src="_static/underscore.js"></script>
         <script type="text/javascript" src="_static/doctools.js"></script>
         <script type="text/javascript" src="_static/language_data.js"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-90545585-1', 'auto');
  ga('send', 'pageview');

</script>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-117752657-2"></script>

<script>
  window.dataLayer = window.dataLayer || [];

  function gtag(){dataLayer.push(arguments);}

  gtag('js', new Date());
  gtag('config', 'UA-117752657-2');
</script>

<img height="1" width="1" style="border-style:none;" alt="" src="https://www.googleadservices.com/pagead/conversion/795629140/?label=txkmCPmdtosBENSssfsC&amp;guid=ON&amp;script=0"/>


  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for PyTorch</p>
          <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
            <li><a href="https://pytorch.org/get-started">Get Started</a></li>
            <li><a href="https://pytorch.org/features">Features</a></li>
            <li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
            <li><a href="https://pytorch.org/blog/">Blog</a></li>
            <li><a href="https://pytorch.org/resources">Resources</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/support">Support</a></li>
            <li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
            <li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
            <li><a href="https://discuss.pytorch.org" target="_blank">Discuss</a></li>
            <li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://pytorch.slack.com" target="_blank">Slack</a></li>
            <li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md" target="_blank">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <ul>
            <li class="list-title">Follow Us</li>
            <li>
              <div id="mc_embed_signup">
                <form
                  action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&id=91d0dccd39"
                  method="post"
                  id="mc-embedded-subscribe-form"
                  name="mc-embedded-subscribe-form"
                  class="email-subscribe-form validate"
                  target="_blank"
                  novalidate>
                  <div id="mc_embed_signup_scroll" class="email-subscribe-form-fields-wrapper">
                    <div class="mc-field-group">
                      <label for="mce-EMAIL" style="display:none;">Email Address</label>
                      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
                    </div>

                    <div id="mce-responses" class="clear">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->

                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" value=""></div>

                    <div class="clear">
                      <input type="submit" value="" name="subscribe" id="mc-embedded-subscribe" class="button email-subscribe-button">
                    </div>
                  </div>
                </form>
              </div>

            </li>
          </ul>

          <div class="footer-social-icons">
            <a href="https://www.facebook.com/pytorch" target="_blank" class="facebook"></a>
            <a href="https://twitter.com/pytorch" target="_blank" class="twitter"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="#">Get Started</a>
          </li>

          <li>
            <a href="#">Features</a>
          </li>

          <li>
            <a href="#">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li class="active">
            <a href="https://pytorch.org/docs/stable/index.html">Docs</a>
          </li>

          <li>
            <a href="https://pytorch.org/resources">Resources</a>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>